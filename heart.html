<html>
  <head>
    <meta charset="utf-8" />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        background-color: #000;
        overflow: hidden;
      }
      canvas {
        position: absolute;
        width: 100%;
        height: 100%;
        display: block;
        animation: heartBeat 1.8s ease-in-out infinite;
        transform-origin: center;
      }
      @keyframes heartBeat {
        0% {
          transform: scale(1);
        }
        30% {
          transform: scale(0.92);
        }
        60% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }
    </style>
  </head>
  <body>
    <canvas id="pinkboard"></canvas>
    <script>
      var settings = {
        particles: {
          length: 3000,
          duration: 2.8,
          velocity: 120,
          effect: -0.85,
          size: 2,
        },
      };
      (function () {
        var lastTime = 0;
        var vendors = ["ms", "moz", "webkit", "o"];
        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
          window.requestAnimationFrame = window[vendors[x] + "RequestAnimationFrame"];
          window.cancelAnimationFrame =
            window[vendors[x] + "CancelAnimationFrame"] ||
            window[vendors[x] + "CancelRequestAnimationFrame"];
        }
        if (!window.requestAnimationFrame)
          window.requestAnimationFrame = function (callback) {
            var currTime = new Date().getTime();
            var timeToCall = Math.max(0, 16 - (currTime - lastTime));
            var id = window.setTimeout(function () {
              callback(currTime + timeToCall);
            }, timeToCall);
            lastTime = currTime + timeToCall;
            return id;
          };
        if (!window.cancelAnimationFrame)
          window.cancelAnimationFrame = function (id) {
            clearTimeout(id);
          };
      })();
      var Point = function (x, y) {
        this.x = x || 0;
        this.y = y || 0;
      };
      Point.prototype.clone = function () {
        return new Point(this.x, this.y);
      };
      Point.prototype.length = function (length) {
        if (length === undefined)
          return Math.sqrt(this.x * this.x + this.y * this.y);
        this.normalize();
        this.x *= length;
        this.y *= length;
        return this;
      };
      Point.prototype.normalize = function () {
        var len = this.length();
        this.x /= len;
        this.y /= len;
        return this;
      };
      var Particle = function () {
        this.position = new Point();
        this.velocity = new Point();
        this.acceleration = new Point();
        this.age = 0;
        this.twinkle = Math.random() * 1.5 + 0.5;
      };
      Particle.prototype.initialize = function (x, y, dx, dy) {
        this.position.x = x;
        this.position.y = y;
        this.velocity.x = dx;
        this.velocity.y = dy;
        this.acceleration.x = dx * settings.particles.effect;
        this.acceleration.y = dy * settings.particles.effect;
        this.age = 0;
        this.twinkle = Math.random() * 1.5 + 0.5;
      };
      Particle.prototype.update = function (deltaTime) {
        this.position.x += this.velocity.x * deltaTime;
        this.position.y += this.velocity.y * deltaTime;
        this.velocity.x += this.acceleration.x * deltaTime;
        this.velocity.y += this.acceleration.y * deltaTime;
        this.age += deltaTime;
      };
      Particle.prototype.draw = function (context) {
        function ease(t) {
          return --t * t * t + 1;
        }
        var progress = this.age / settings.particles.duration;
        var size = settings.particles.size * ease(progress);
        var alpha = (1 - progress) * this.twinkle * (0.6 + Math.random() * 0.4);
        var hue = 340 + Math.random() * 40;
        var gradient = context.createRadialGradient(
          this.position.x,
          this.position.y,
          0,
          this.position.x,
          this.position.y,
          size * 2
        );
        gradient.addColorStop(0, `hsla(${hue},100%,70%,${alpha})`);
        gradient.addColorStop(0.4, `hsla(${hue},100%,50%,${alpha})`);
        gradient.addColorStop(1, "rgba(255,255,255,0)");
        context.beginPath();
        context.fillStyle = gradient;
        context.arc(this.position.x, this.position.y, size * 1.5, 0, Math.PI * 2, false);
        context.fill();
        if (Math.random() < 0.2) {
          context.beginPath();
          context.moveTo(this.position.x - size, this.position.y);
          context.lineTo(this.position.x + size, this.position.y);
          context.moveTo(this.position.x, this.position.y - size);
          context.lineTo(this.position.x, this.position.y + size);
          context.strokeStyle = `hsla(${hue},100%,85%,${alpha * 0.8})`;
          context.lineWidth = 0.8;
          context.stroke();
        }
      };
      var ParticlePool = function (length) {
        var particles = new Array(length);
        for (var i = 0; i < length; i++) particles[i] = new Particle();
        var firstActive = 0,
          firstFree = 0,
          duration = settings.particles.duration;
        this.add = function (x, y, dx, dy) {
          particles[firstFree].initialize(x, y, dx, dy);
          firstFree++;
          if (firstFree == length) firstFree = 0;
          if (firstActive == firstFree) {
            firstActive++;
            if (firstActive == length) firstActive = 0;
          }
        };
        this.update = function (deltaTime) {
          if (firstActive < firstFree) {
            for (var i = firstActive; i < firstFree; i++) particles[i].update(deltaTime);
          } else if (firstFree < firstActive) {
            for (var i = firstActive; i < length; i++) particles[i].update(deltaTime);
            for (var i = 0; i < firstFree; i++) particles[i].update(deltaTime);
          }
          while (particles[firstActive].age >= duration && firstActive != firstFree) {
            firstActive++;
            if (firstActive == length) firstActive = 0;
          }
        };
        this.draw = function (context) {
          if (firstActive < firstFree) {
            for (var i = firstActive; i < firstFree; i++) particles[i].draw(context);
          } else if (firstFree < firstActive) {
            for (var i = firstActive; i < length; i++) particles[i].draw(context);
            for (var i = 0; i < firstFree; i++) particles[i].draw(context);
          }
        };
      };
      (function (canvas) {
        var context = canvas.getContext("2d"),
          particles = new ParticlePool(settings.particles.length),
          particleRate = settings.particles.length / settings.particles.duration,
          time;
        function pointOnHeart(t) {
          return new Point(
            160 * Math.pow(Math.sin(t), 3),
            130 * Math.cos(t) -
              50 * Math.cos(2 * t) -
              20 * Math.cos(3 * t) -
              10 * Math.cos(4 * t) +
              25
          );
        }
        function render() {
          requestAnimationFrame(render);
          var newTime = new Date().getTime() / 1000,
            deltaTime = newTime - (time || newTime);
          time = newTime;
          context.clearRect(0, 0, canvas.width, canvas.height);
          var amount = particleRate * deltaTime;
          for (var i = 0; i < amount; i++) {
            var pos = pointOnHeart(Math.PI - 2 * Math.PI * Math.random());
            if (Math.abs(pos.x) < 15 && Math.random() < 0.8) continue;
            var dir = pos.clone().length(settings.particles.velocity);
            particles.add(
              canvas.width / 2 + pos.x,
              canvas.height / 2 - pos.y,
              dir.x,
              -dir.y
            );
          }
          particles.update(deltaTime);
          particles.draw(context);
        }
        function onResize() {
          canvas.width = canvas.clientWidth;
          canvas.height = canvas.clientHeight;
        }
        window.onresize = onResize;
        setTimeout(function () {
          onResize();
          render();
        }, 10);
      })(document.getElementById("pinkboard"));
    </script>
  </body>
</html>
